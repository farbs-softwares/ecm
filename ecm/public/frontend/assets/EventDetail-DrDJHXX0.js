var G=Object.defineProperty;var q=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var j=(e,o,t)=>o in e?G(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,P=(e,o)=>{for(var t in o||(o={}))J.call(o,t)&&j(e,t,o[t]);if(q)for(var t of q(o))K.call(o,t)&&j(e,t,o[t]);return e};import{x as v,C as x,F as w,I as a,as as Y,a1 as Z,K as k,P as Q,a9 as A,aa as V,a as M,k as D,w as X,L as u,a8 as E,D as H,G as s,r as C,j as S,ad as I,y,J as d,H as O,ac as ee,a7 as $,a2 as z,B as te,d as F,Z as R,$ as U,at as ae,b as T,ap as se}from"./frappe-ui-BA0w7BnF.js";import{c as N,B as le,U as ne,a as ie,b as B,u as oe}from"./index-CXG1Q5KM.js";import{_ as re}from"./EventOutline-teyq-0fu.js";const de={__name:"UserAvatar",props:{user:{type:Object,default:null},size:{type:String}},setup(e){return(o,t)=>(v(),x(a(Q),{text:e.user.full_name},{default:w(()=>[e.user?(v(),x(a(Y),Z({key:0,class:"avatar border border-gray-300 cursor-auto",label:e.user.full_name,image:e.user.user_image,size:e.size},o.$attrs),null,16,["label","image","size"])):k("",!0)]),_:1},8,["text"]))}},ue=s("div",{class:"my-3 leading-6"},null,-1),me={__name:"NegotiateModal",props:A({event:{type:String,required:!0},offerDetail:{type:Object}},{modelValue:{},modelModifiers:{},outline:{},outlineModifiers:{}}),emits:["update:modelValue","update:outline"],setup(e){const o=V(e,"modelValue"),t=V(e,"outline"),f=e,c=M({title:""}),i=M({details:"",suggested_price:0,about_me:""}),p=D({url:"frappe.client.insert",makeParams(n){return{doc:{doctype:"Event Offers",offer:i.details,about_me:i.about_me,event:f.event,suggested_price:i.suggested_price}}}}),g=D({url:"frappe.client.set_value",makeParams(n){var m;return{doctype:"Event Offers",name:(m=f.offerDetail)==null?void 0:m.name,fieldnames:["offer","about_me","suggested_price"],values:[i.details,i.about_me,i.suggested_price]}}}),h=n=>{p.submit({},{validate(){if(!i.details)return"Details is required"},onSuccess:m=>{N({text:"Your Offer sent to event Creater successfully",icon:"check",iconClasses:"bg-green-600 text-white rounded-md p-px"}),n()},onError(m){r(m)}})},l=n=>{g.submit({},{validate(){if(!c.title)return"Title is required"},onSuccess(){t.value.reload(),N({text:"Chapter updated successfully",icon:"check",iconClasses:"bg-green-600 text-white rounded-md p-px"}),n()},onError(m){r(m)}})},r=n=>{var m;N({title:"Error",text:((m=n.messages)==null?void 0:m[0])||n,icon:"x",iconClasses:"bg-red-600 text-white rounded-md p-px",position:"top-center",timeout:10})};return X(()=>f.chapterDetail,n=>{c.title=n==null?void 0:n.title}),(n,m)=>(v(),x(a(H),{modelValue:o.value,"onUpdate:modelValue":m[3]||(m[3]=b=>o.value=b),options:{title:n.__("Send Offer"),size:"lg",actions:[{label:n.chapterDetail?n.__("Edit Offer"):n.__("Send Offer"),variant:"solid",onClick:b=>n.chapterDetail?l(b):h(b)}]}},{"body-content":w(()=>[ue,u(a(E),{label:"Details",modelValue:i.details,"onUpdate:modelValue":m[0]||(m[0]=b=>i.details=b),class:"mb-4",type:"textarea"},null,8,["modelValue"]),u(a(E),{label:"Sugessted price",modelValue:i.suggested_price,"onUpdate:modelValue":m[1]||(m[1]=b=>i.suggested_price=b),class:"mb-4"},null,8,["modelValue"]),u(a(E),{label:"About Me",modelValue:i.about_me,"onUpdate:modelValue":m[2]||(m[2]=b=>i.about_me=b),class:"mb-4",type:"textarea"},null,8,["modelValue"])]),_:1},8,["modelValue","options"]))}},ce={class:"shadow rounded-md min-w-80"},ve=["src"],_e={key:0,class:"image-placeholder"},fe={class:"p-5"},ge={key:0,class:"text-2xl font-semibold mb-3"},pe={key:3,class:"bg-blue-100 text-blue-900 text-sm rounded-md py-1 px-3"},be={class:"mt-8 mb-4 font-medium"},he={class:"flex items-center mb-3"},we={class:"ml-2"},ye={class:"flex items-center mb-3"},ke={class:"ml-2"},xe={class:"flex items-center mb-3"},$e={class:"ml-2"},De={class:"flex items-center"},Ve={class:"ml-2"},L={__name:"EventCardOverlay",props:{eventDetail:{type:Object,default:null},eventName:{type:String,required:!0}},setup(e){te();const o=F("$user"),t=C(null),f=C(!1),c=()=>t.value,i=e,p=S(()=>i.eventDetail.data.video_link?"https://www.youtube.com/embed/"+i.eventDetail.data.video_link:null),g=(l=null)=>{t.value=l,f.value=!0},h=()=>{var r,n;let l=!1;return((r=i.eventDetail.data)==null?void 0:r.owner)==((n=o.data)==null?void 0:n.name)&&(l=!0),l};return(l,r)=>{var m,b;const n=I("router-link");return v(),y("div",ce,[e.eventDetail.data.video_link?(v(),y("iframe",{key:0,src:p.value,class:"rounded-t-md min-h-56 w-full"},null,8,ve)):k("",!0),s("div",{class:O(["rounded-t-md min-h-56 w-full",{"default-image":!e.eventDetail.data.cover_image}]),style:ee({backgroundImage:"url('"+encodeURI(e.eventDetail.data.cover_image)+"')"})},[e.eventDetail.data.cover_image?k("",!0):(v(),y("div",_e,d(e.eventDetail.data.title[0]),1))],6),s("div",fe,[e.eventDetail.data.price?(v(),y("div",ge,d(e.eventDetail.data.price),1)):k("",!0),e.eventDetail.data.membership?(v(),x(n,{key:1,to:{name:"Lesson",params:{eventName:e.eventDetail.name,chapterNumber:e.eventDetail.data.current_lesson?e.eventDetail.data.current_lesson.split("-")[0]:1,lessonNumber:e.eventDetail.data.current_lesson?e.eventDetail.data.current_lesson.split("-")[1]:1}}},{default:w(()=>[u(a($),{variant:"solid",size:"md",class:"w-full"},{default:w(()=>[s("span",null,d(l.__("Continue Learning")),1)]),_:1})]),_:1},8,["to"])):e.eventDetail.data.paid_course?(v(),x(n,{key:2,to:{name:"Billing",params:{type:"eventDetail",name:e.eventDetail.data.name}}},{default:w(()=>[u(a($),{variant:"solid",size:"md",class:"w-full"},{default:w(()=>[s("span",null,d(l.__("Buy this eventDetail")),1)]),_:1})]),_:1},8,["to"])):e.eventDetail.data.disable_self_learning?(v(),y("div",pe,d(l.__("Contact the Administrator to enroll for this eventDetail.")),1)):k("",!0),u(a($),{variant:"solid",class:"w-full",size:"md",onClick:r[0]||(r[0]=_=>g())},{default:w(()=>[z(d(l.__("Negotiate")),1)]),_:1}),(b=(m=a(o))==null?void 0:m.data)!=null&&b.is_moderator||h()?(v(),x(n,{key:4,to:{name:"CreateEvent",params:{eventName:e.eventDetail.data.name}}},{default:w(()=>[u(a($),{variant:"subtle",class:"w-full mt-2",size:"md"},{default:w(()=>[s("span",null,d(l.__("Edit")),1)]),_:1}),u(a($),{variant:"solid",class:"w-full",size:"md",onClick:r[1]||(r[1]=_=>g())},{default:w(()=>[z(d(l.__("Bookmark")),1)]),_:1})]),_:1},8,["to"])):k("",!0),s("div",be,d(l.__("This eventDetail has:")),1),s("div",he,[u(a(le),{class:"h-5 w-5 stroke-1.5 text-gray-600"}),s("span",we,d(e.eventDetail.data.lesson_count)+" "+d(l.__("Tasks")),1)]),s("div",ye,[u(a(ne),{class:"h-5 w-5 stroke-1.5 text-gray-600"}),s("span",ke,d(e.eventDetail.data.enrollment_count_formatted)+" "+d(l.__("Suggestion")),1)]),s("div",xe,[u(a(ie),{class:"h-5 w-5 stroke-1.5 text-gray-600"}),s("span",$e,d(e.eventDetail.data.enrollment_count_formatted)+" "+d(l.__("Bookmarks")),1)]),s("div",De,[u(a(B),{class:"h-5 w-5 stroke-1.5 fill-orange-500 text-gray-50"}),s("span",Ve,d(e.eventDetail.data.avg_rating)+" "+d(l.__("Rating")),1)])]),u(me,{modelValue:f.value,"onUpdate:modelValue":r[2]||(r[2]=_=>f.value=_),eventDetail:i.eventDetail.data.name,chapterDetail:c()},null,8,["modelValue","eventDetail","chapterDetail"])])}}},Re={class:"flex text-center"},Ne={__name:"Rating",props:{id:{type:String,default:""},modelValue:{type:Number,default:0}},emits:["update:modelValue"],setup(e,{emit:o}){const t=e,f=o;let c=C(t.modelValue),i=g=>{f("update:modelValue",g)};function p(g){i(g),c.value=g}return(g,h)=>(v(),y("div",Re,[(v(),y(R,null,U(5,l=>s("div",null,[u(a(B),{class:O([l<=a(c)?"fill-orange-500":"","h-6 w-6 fill-gray-400 text-gray-50 mr-1 cursor-pointer"]),onClick:r=>p(l)},null,8,["class","onClick"])])),64))]))}},Ce={class:"flex flex-col gap-4"},Ee={class:"mb-1.5 text-sm text-gray-600"},Me={class:"mb-1.5 text-sm text-gray-600"},Se={__name:"ReviewModal",props:A({eventName:{type:String,required:!0}},{modelValue:{},modelModifiers:{},reloadReviews:{},reloadReviewsModifiers:{},hasReviewed:{},hasReviewedModifiers:{}}),emits:["update:modelValue","update:reloadReviews","update:hasReviewed"],setup(e){const o=V(e,"modelValue"),t=V(e,"reloadReviews"),f=V(e,"hasReviewed");let c=M({review:"",rating:0});const i=e,p=D({url:"frappe.client.insert",makeParams(h){return{doc:P({doctype:"LMS Course Review",course:i.eventName},h)}}});function g(h){c.rating=c.rating/5,p.submit(c,{validate(){if(!c.rating)return"Please enter a rating."},onSuccess(){t.value.reload(),f.value.reload()},onError(l){var r;N({text:((r=l.messages)==null?void 0:r[0])||l,icon:"x",iconClasses:"text-red-600 bg-red-300"})}}),h()}return(h,l)=>(v(),x(a(H),{modelValue:o.value,"onUpdate:modelValue":l[2]||(l[2]=r=>o.value=r),options:{title:h.__("Write a Review"),size:"xl",actions:[{label:"Submit",variant:"solid",onClick:r=>g(r)}]}},{"body-content":w(()=>[s("div",Ce,[s("div",null,[s("div",Ee,d(h.__("Rating")),1),u(Ne,{modelValue:a(c).rating,"onUpdate:modelValue":l[0]||(l[0]=r=>a(c).rating=r)},null,8,["modelValue"])]),s("div",null,[s("div",Me,d(h.__("Review")),1),u(a(ae),{type:"text",size:"md",rows:"5",modelValue:a(c).review,"onUpdate:modelValue":l[1]||(l[1]=r=>a(c).review=r)},null,8,["modelValue"])])])]),_:1},8,["modelValue","options"]))}},ze={key:0,class:"mt-20 mb-10"},Ue={class:"flex items-center font-semibold text-2xl"},Oe={class:"grid gap-8 mt-10"},Be={class:"flex items-center"},qe={class:"mx-4"},je={class:"text-lg font-medium mr-4"},Pe={class:"flex mt-2"},Te={key:0,class:"mt-4 leading-5"},Le={__name:"EventReviews",props:{eventName:{type:String,required:!0},avg_rating:{type:Number,required:!0},membership:{type:Object,required:!1}},setup(e){var g,h,l;const o=F("$user"),t=e,f=D({url:"frappe.client.get_count",cache:["eligible_to_review",t.eventName,(g=t.membership)==null?void 0:g.member],params:{doctype:"ECM Event Review",filters:{event:t.eventName,owner:(h=t.membership)==null?void 0:h.member}},auto:!!((l=o.data)!=null&&l.name)}),c=D({url:"ecm.events_connect_management.utils.get_reviews",cache:["event_reviews",t.eventName],params:{event:t.eventName},auto:!0}),i=C(!1);function p(){i.value=!0}return(r,n)=>{var b;const m=I("router-link");return v(),y(R,null,[(b=a(c).data)!=null&&b.length||e.membership?(v(),y("div",ze,[e.membership&&!a(f).data?(v(),x(a($),{key:0,onClick:n[0]||(n[0]=_=>p()),class:"float-right"},{default:w(()=>[z(d(r.__("Write a Review")),1)]),_:1})):k("",!0),s("div",Ue,d(r.__("Student Reviews")),1),s("div",Oe,[(v(!0),y(R,null,U(a(c).data,(_,et)=>(v(),y("div",null,[s("div",Be,[u(m,{to:{name:"Profile",params:{username:_.owner_details.username}}},{default:w(()=>[u(de,{user:_.owner_details,size:"2xl"},null,8,["user"])]),_:2},1032,["to"]),s("div",qe,[u(m,{to:{name:"Profile",params:{username:_.owner_details.username}}},{default:w(()=>[s("span",je,d(_.owner_details.full_name),1)]),_:2},1032,["to"]),s("span",null,d(_.creation),1),s("div",Pe,[(v(),y(R,null,U(5,W=>u(a(B),{class:O(["h-5 w-5 text-gray-100 bg-gray-200 rounded-sm mr-2",W<=Math.ceil(_.rating)?"fill-orange-500":"fill-gray-600"])},null,8,["class"])),64))])])]),_.review?(v(),y("div",Te,d(_.review),1)):k("",!0)]))),256))])])):k("",!0),u(Se,{modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=_=>i.value=_),reloadReviews:a(c),"onUpdate:reloadReviews":n[2]||(n[2]=_=>T(c)?c.value=_:null),hasReviewed:a(f),"onUpdate:hasReviewed":n[3]||(n[3]=_=>T(f)?f.value=_:null),eventName:e.eventName},null,8,["modelValue","reloadReviews","hasReviewed","eventName"])],64)}}},Ae={key:0},He={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-3 py-2.5 sm:px-5"},Ie={class:"m-5"},Fe={class:"flex justify-between w-full"},We={class:"md:w-2/3"},Ge={class:"text-3xl font-semibold"},Je={class:"my-3 leading-6"},Ke=s("div",{class:"flex items-center"},null,-1),Ye=s("div",{class:"flex mt-3 mb-4 w-fit"},null,-1),Ze=["innerHTML"],Qe={class:"mt-10"},Xe={class:"hidden md:block"},nt={__name:"EventDetail",props:{eventName:{type:String,required:!0}},setup(e){const o=e,t=D({url:"ecm.events_connect_management.utils.get_event_details",cache:["event",o.eventName],params:{event:o.eventName},auto:!0}),f=S(()=>{var p,g;let i=[{label:"All Events",route:{name:"Events"}}];return i.push({label:(p=t==null?void 0:t.data)==null?void 0:p.title,route:{name:"EventDetail",params:{eventName:(g=t==null?void 0:t.data)==null?void 0:g.name}}}),i}),c=S(()=>{var i,p;return{title:(i=t==null?void 0:t.data)==null?void 0:i.title,description:(p=t==null?void 0:t.data)==null?void 0:p.about_event}});return oe(c),(i,p)=>a(t).data?(v(),y("div",Ae,[s("header",He,[u(a(se),{class:"h-7",items:f.value},null,8,["items"])]),s("div",Ie,[s("div",Fe,[s("div",We,[s("div",Ge,d(a(t).data.title),1),s("div",Je,d(a(t).data.about_event),1),Ke,Ye,u(L,{eventDetail:a(t),class:"md:hidden mb-4"},null,8,["eventDetail"]),s("div",{innerHTML:a(t).data.full_description,class:"course-description"},null,8,Ze),s("div",Qe,[u(re,{eventName:a(t).data.name,showOutline:!0},null,8,["eventName"])]),u(Le,{eventName:a(t).data.title},null,8,["eventName"])]),s("div",Xe,[u(L,{eventDetail:a(t)},null,8,["eventDetail"])])])])])):k("",!0)}};export{nt as default};
//# sourceMappingURL=EventDetail-DrDJHXX0.js.map
