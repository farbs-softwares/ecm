{"version":3,"file":"Events-CwAyOWqg.js","sources":["../../../../frontend/src/components/EventCard.vue","../../../../frontend/src/components/CategoryFilter.vue","../../../../frontend/src/components/Controls/MultiSelect.vue","../../../../frontend/src/pages/Events.vue"],"sourcesContent":["<template>\n\t<div\n\t\tv-if=\"eventv.title\"\n\t\tclass=\"flex flex-col h-full rounded-md shadow-md text-base overflow-auto\"\n\t\tstyle=\"min-height: 320px\"\n\t>\n\t\t<div\n\t\t\tclass=\"course-image\"\n\t\t\t:class=\"{ 'default-image': !eventv.cover_image }\"\n\t\t\t:style=\"{ backgroundImage: 'url(\\'' + encodeURI(eventv.cover_image) + '\\')' }\"\n\t\t>\n\t\t\t<div class=\"flex relative top-4 left-4 w-fit flex-wrap\">\n\t\t\t\t<!-- <Badge\n\t\t\t\t\tv-if=\"course.featured\"\n\t\t\t\t\tvariant=\"subtle\"\n\t\t\t\t\ttheme=\"green\"\n\t\t\t\t\tsize=\"md\"\n\t\t\t\t\tclass=\"mr-2\"\n\t\t\t\t>\n\t\t\t\t\t{{ __('Featured') }}\n\t\t\t\t</Badge>\n\t\t\t\t<Badge\n\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\ttheme=\"gray\"\n\t\t\t\t\tsize=\"md\"\n\t\t\t\t\tclass=\"mr-2\"\n\t\t\t\t\tv-for=\"tag in course.tags\"\n\t\t\t\t>\n\t\t\t\t\t{{ tag }}\n\t\t\t\t</Badge> -->\n\t\t\t</div>\n\t\t\t<div v-if=\"!eventv.cover_image\" class=\"image-placeholder\">\n\t\t\t\t{{ eventv.title[0] }}\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"flex flex-col flex-auto p-4\">\n\t\t\t<div class=\"flex items-center justify-between mb-2\">\n\t\t\t<!-- \t<div v-if=\"course.lesson_count\">\n\t\t\t\t\t<Tooltip :text=\"__('Lessons')\">\n\t\t\t\t\t\t<span class=\"flex items-center\">\n\t\t\t\t\t\t\t<BookOpen class=\"h-4 w-4 stroke-1.5 text-gray-700 mr-1\" />\n\t\t\t\t\t\t\t{{ course.lesson_count }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div> -->\n\n\t\t\t<!-- \t<div v-if=\"course.enrollment_count\">\n\t\t\t\t\t<Tooltip :text=\"__('Enrolled Students')\">\n\t\t\t\t\t\t<span class=\"flex items-center\">\n\t\t\t\t\t\t\t<Users class=\"h-4 w-4 stroke-1.5 text-gray-700 mr-1\" />\n\t\t\t\t\t\t\t{{ course.enrollment_count }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\n\t\t\t\t<div v-if=\"course.avg_rating\">\n\t\t\t\t\t<Tooltip :text=\"__('Average Rating')\">\n\t\t\t\t\t\t<span class=\"flex items-center\">\n\t\t\t\t\t\t\t<Star class=\"h-4 w-4 stroke-1.5 text-gray-700 mr-1\" />\n\t\t\t\t\t\t\t{{ course.avg_rating }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div> -->\n\n\t\t\t<!-- \t<div v-if=\"course.status != 'Approved'\">\n\t\t\t\t\t<Badge\n\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\t:theme=\"course.status === 'Under Review' ? 'orange' : 'blue'\"\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ course.status }}\n\t\t\t\t\t</Badge>\n\t\t\t\t</div> -->\n\t\t\t</div>\n\n\t\t\t<div class=\"text-xl font-semibold leading-6\">\n\t\t\t\t{{ eventv.title }}\n\t\t\t</div>\n\n\t\t\t<div class=\"short-introduction\">\n\t\t\t\t{{ eventv.about_event }}\n\t\t\t</div>\n\n\t\t\t<!-- <ProgressBar\n\t\t\t\tv-if=\"user && course.membership\"\n\t\t\t\t:progress=\"course.membership.progress\"\n\t\t\t/> -->\n\n\t\t<!-- \t<div v-if=\"user && course.membership\" class=\"text-sm mb-4\">\n\t\t\t\t{{ Math.ceil(course.membership.progress) }}% completed\n\t\t\t</div> -->\n\t\t\t<div class=\"flex items-center justify-between mt-auto\">\n\t\t\t\t<div class=\"flex avatar-group overlap\">\n\t\t\t\t\n\t\t\t\t\t<div class=\"font-thin\">\n\t\t\t\t\t\t{{ eventv.start_date }} - {{ eventv.start_time }} to {{ eventv.finish_time }}\n\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t\n\t\t\t</div>\n\t\t\t<div class=\"flex items-center justify-between mt-auto\">\n\t\t\t\t<div class=\"flex avatar-group overlap\">\n\t\t\t\t\t<!-- <div\n\t\t\t\t\t\tclass=\"h-6 mr-1\"\n\t\t\t\t\t\t:class=\"{ 'avatar-group overlap': course.instructors.length > 1 }\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<UserAvatar\n\t\t\t\t\t\t\tv-for=\"instructor in course.instructors\"\n\t\t\t\t\t\t\t:user=\"instructor\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div> -->\n\t\t\t\t\t<div class=\"font-semibold\">\n\t\t\t\t\t\t{{ eventv.location }}\n\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"font-semibold\">\n\t\t\t\t\tCost\t{{ eventv.suggested_cost }} USD\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport { BookOpen, Users, Star } from 'lucide-vue-next'\nimport UserAvatar from '@/components/UserAvatar.vue'\nimport { sessionStore } from '@/stores/session'\nimport { Badge, Tooltip } from 'frappe-ui'\n\nimport ProgressBar from '@/components/ProgressBar.vue'\n\nconst { user } = sessionStore()\n\nconst props = defineProps({\n\teventv: {\n\t\ttype: Object,\n\t\tdefault: null,\n\t},\n})\n</script>\n<style>\n.course-image {\n\theight: 168px;\n\twidth: 100%;\n\tbackground-size: cover;\n\tbackground-position: center;\n\tbackground-repeat: no-repeat;\n}\n\n.course-card-pills {\n\tbackground: #ffffff;\n\tmargin-left: 0;\n\tmargin-right: 0.5rem;\n\tpadding: 3.5px 8px;\n\tfont-size: 11px;\n\ttext-align: center;\n\tletter-spacing: 0.011em;\n\ttext-transform: uppercase;\n\tfont-weight: 600;\n\twidth: fit-content;\n}\n\n.default-image {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tbackground-color: theme('colors.green.100');\n\tcolor: theme('colors.green.600');\n}\n\n.avatar-group {\n\tdisplay: inline-flex;\n\talign-items: center;\n}\n\n.avatar-group .avatar {\n\ttransition: margin 0.1s ease-in-out;\n}\n.image-placeholder {\n\tdisplay: flex;\n\talign-items: center;\n\tflex: 1;\n\tfont-size: 5rem;\n\tcolor: theme('colors.gray.700');\n\tfont-weight: 600;\n}\n.avatar-group.overlap .avatar + .avatar {\n\tmargin-left: calc(-8px);\n}\n\n.short-introduction {\n\tdisplay: -webkit-box;\n\t-webkit-line-clamp: 2;\n\t-webkit-box-orient: vertical;\n\ttext-overflow: ellipsis;\n\twidth: 100%;\n\toverflow: hidden;\n\tmargin: 0.25rem 0 1.25rem;\n\tline-height: 1.5;\n}\n</style>\n","<template>\r\n\t<div class=\"flex justify-between items-center\">\r\n\t\t<div class=\"flex space-x-2 text-xl\">\r\n\t\t\t{{ __('Filter Events') }}\r\n\t\t</div>\r\n\t\t<div class=\"flex flex-wrap gap-4\">\r\n    <div v-for=\"(category, index) in categories\" :key=\"index\" class=\"flex items-center\">\r\n\t\t\t\t<Switch\r\n\t\t\t\t\tsize=\"sm\"\r\n\t\t\t\t\t:label=\"category.category\"\r\n\t\t\t\t\t:disabled=\"false\"\r\n\t\t\t\t\tv-model=\"category.checked\"\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, ref,watch } from 'vue'\r\nimport { Switch,createResource,} from 'frappe-ui'\r\nconst props = defineProps({\r\n\tcategories: {\r\n\t\ttype: Array,\r\n\t\trequired: true,\r\n\t},\r\n})\r\nconst state = reactive({\r\n      categories: props.categories.map(category => ({\r\n        ...category,\r\n        checked: category.checked !== undefined ? category.checked : true // Default to true if not defined\r\n      }))\r\n    });\r\n\r\n    // Watch for changes in the props to update the internal state\r\n    watch(() => props.categories, (newCategories) => {\r\n      state.categories = newCategories.map(category => ({\r\n        ...category,\r\n        checked: category.checked !== undefined ? category.checked : true\r\n      }));\r\n    });\r\n\r\n    // Emit changes to the parent component\r\n    function emitChanges() {\r\n      emit('update:categories', state.categories);\r\n    }\r\n/* const categories = reactive({\r\n\tcategory: '',\r\n\tchecked: true,\r\n}) */\r\nconst categoryResource = createResource({\r\n\turl: 'ecm.events_connect_management.utils.get_categories',\r\n\tparams: {\r\n\t\tcategory_filter: JSON.stringify(props.categories),\r\n\t},\r\n\tauto: true,\r\n\tonSuccess(data) {\r\n\t\tprops.categories.splice(0, props.categories.length, ...data);\r\n\t}\r\n\r\n})\r\n// Method to filter checked categories\r\nfunction getCheckedCategories() {\r\n      return categories.filter(category => category.checked);\r\n    }\r\n\r\n</script>\r\n","<template>\n\t<div>\n\t\t<label class=\"block mb-1\" :class=\"labelClasses\" v-if=\"label\">\n\t\t\t{{ label }}\n\t\t</label>\n\t\t<div class=\"grid grid-cols-3 gap-1\">\n\t\t\t<Button\n\t\t\t\tref=\"emails\"\n\t\t\t\tv-for=\"value in values\"\n\t\t\t\t:key=\"value\"\n\t\t\t\t:label=\"value\"\n\t\t\t\ttheme=\"gray\"\n\t\t\t\tvariant=\"subtle\"\n\t\t\t\tclass=\"rounded-md\"\n\t\t\t\t@keydown.delete.capture.stop=\"removeLastValue\"\n\t\t\t>\n\t\t\t\t<template #suffix>\n\t\t\t\t\t<X @click=\"removeValue(value)\" class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t</template>\n\t\t\t</Button>\n\t\t\t<div class=\"\">\n\t\t\t\t<Combobox v-model=\"selectedValue\" nullable>\n\t\t\t\t\t<Popover class=\"w-full\" v-model:show=\"showOptions\">\n\t\t\t\t\t\t<template #target=\"{ togglePopover }\">\n\t\t\t\t\t\t\t<ComboboxInput\n\t\t\t\t\t\t\t\tref=\"search\"\n\t\t\t\t\t\t\t\tclass=\"search-input form-input w-full focus-visible:!ring-0\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t:value=\"query\"\n\t\t\t\t\t\t\t\t@change=\"\n\t\t\t\t\t\t\t\t\t(e) => {\n\t\t\t\t\t\t\t\t\t\tquery = e.target.value\n\t\t\t\t\t\t\t\t\t\tshowOptions = true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\t\t\t\t@focus=\"() => togglePopover()\"\n\t\t\t\t\t\t\t\t@keydown.delete.capture.stop=\"removeLastValue\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #body=\"{ isOpen }\">\n\t\t\t\t\t\t\t<div v-show=\"isOpen\">\n\t\t\t\t\t\t\t\t<div class=\"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl\">\n\t\t\t\t\t\t\t\t\t<ComboboxOptions\n\t\t\t\t\t\t\t\t\t\tclass=\"my-1 max-h-[12rem] overflow-y-auto px-1.5\"\n\t\t\t\t\t\t\t\t\t\tstatic\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<ComboboxOption\n\t\t\t\t\t\t\t\t\t\t\tv-for=\"option in options\"\n\t\t\t\t\t\t\t\t\t\t\t:key=\"option.value\"\n\t\t\t\t\t\t\t\t\t\t\t:value=\"option\"\n\t\t\t\t\t\t\t\t\t\t\tv-slot=\"{ active }\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\t\t\t\t:class=\"[\n\t\t\t\t\t\t\t\t\t\t\t\t\t'flex cursor-pointer items-center rounded px-2 py-1 text-base',\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ 'bg-gray-100': active },\n\t\t\t\t\t\t\t\t\t\t\t\t]\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"flex flex-col gap-1 p-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-base font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ option.description }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"text-sm text-gray-600\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{ option.value }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\t</ComboboxOption>\n\t\t\t\t\t\t\t\t\t</ComboboxOptions>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Popover>\n\t\t\t\t</Combobox>\n\t\t\t</div>\n\t\t</div>\n\t\t<!-- <ErrorMessage class=\"mt-2 pl-2\" v-if=\"error\" :message=\"error\" /> -->\n\t</div>\n</template>\n\n<script setup>\nimport {\n\tCombobox,\n\tComboboxInput,\n\tComboboxOptions,\n\tComboboxOption,\n} from '@headlessui/vue'\nimport { createResource, Popover, Button } from 'frappe-ui'\nimport { ref, computed, nextTick } from 'vue'\nimport { watchDebounced } from '@vueuse/core'\nimport { X } from 'lucide-vue-next'\n\nconst props = defineProps({\n\tlabel: {\n\t\ttype: String,\n\t},\n\tsize: {\n\t\ttype: String,\n\t\tdefault: 'sm',\n\t},\n\tdoctype: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tfilters: {\n\t\ttype: Object,\n\t\tdefault: () => ({}),\n\t},\n\tvalidate: {\n\t\ttype: Function,\n\t\tdefault: null,\n\t},\n\terrorMessage: {\n\t\ttype: Function,\n\t\tdefault: (value) => `${value} is an Invalid value`,\n\t},\n})\n\nconst values = defineModel()\n\nconst emails = ref([])\nconst search = ref(null)\nconst error = ref(null)\nconst query = ref('')\nconst text = ref('')\nconst showOptions = ref(false)\n\nconst selectedValue = computed({\n\tget: () => query.value || '',\n\tset: (val) => {\n\t\tquery.value = ''\n\t\tif (val) {\n\t\t\tshowOptions.value = false\n\t\t}\n\t\tval?.value && addValue(val.value)\n\t},\n})\n\nwatchDebounced(\n\tquery,\n\t(val) => {\n\t\tval = val || ''\n\t\tif (text.value === val) return\n\t\ttext.value = val\n\t\treload(val)\n\t},\n\t{ debounce: 300, immediate: true }\n)\n\nconst filterOptions = createResource({\n\turl: 'frappe.desk.search.search_link',\n\tmethod: 'POST',\n\tcache: [text.value, props.doctype],\n\tparams: {\n\t\ttxt: text.value,\n\t\tdoctype: props.doctype,\n\t},\n\t/* transform: (data) => {\n        let allData = data\n            .filter((c) => {\n                return c.description.split(', ')[1]\n            })\n            .map((option) => {\n                let email = option.description.split(', ')[1]\n                return {\n                    label: option.label || email,\n                    value: email,\n                }\n            })\n        return allData\n    }, */\n})\n\nconst options = computed(() => {\n\treturn filterOptions.data || []\n})\n\nfunction reload(val) {\n\tfilterOptions.update({\n\t\tparams: {\n\t\t\ttxt: val,\n\t\t\tdoctype: props.doctype,\n\t\t},\n\t})\n\tfilterOptions.reload()\n}\n\nconst addValue = (value) => {\n\terror.value = null\n\tif (value) {\n\t\tconst splitValues = value.split(',')\n\t\tsplitValues.forEach((value) => {\n\t\t\tvalue = value.trim()\n\t\t\tif (value) {\n\t\t\t\t// check if value is not already in the values array\n\t\t\t\tif (!values.value?.includes(value)) {\n\t\t\t\t\t// check if value is valid\n\t\t\t\t\tif (value && props.validate && !props.validate(value)) {\n\t\t\t\t\t\terror.value = props.errorMessage(value)\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\t// add value to values array\n\t\t\t\t\tif (!values.value) {\n\t\t\t\t\t\tvalues.value = [value]\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalues.value.push(value)\n\t\t\t\t\t}\n\t\t\t\t\tvalue = value.replace(value, '')\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\t!error.value && (value = '')\n\t}\n}\n\nconst removeValue = (value) => {\n\tvalues.value = values.value.filter((v) => v !== value)\n}\n\nconst removeLastValue = () => {\n\tif (query.value) return\n\n\tlet emailRef = emails.value[emails.value.length - 1]?.$el\n\tif (document.activeElement === emailRef) {\n\t\tvalues.value.pop()\n\t\tnextTick(() => {\n\t\t\tif (values.value.length) {\n\t\t\t\temailRef = emails.value[emails.value.length - 1].$el\n\t\t\t\temailRef?.focus()\n\t\t\t} else {\n\t\t\t\tsetFocus()\n\t\t\t}\n\t\t})\n\t} else {\n\t\temailRef?.focus()\n\t}\n}\n\nfunction setFocus() {\n\tsearch.value.$el.focus()\n}\n\ndefineExpose({ setFocus })\n\nconst labelClasses = computed(() => {\n\treturn [\n\t\t{\n\t\t\tsm: 'text-xs',\n\t\t\tmd: 'text-base',\n\t\t}[props.size || 'sm'],\n\t\t'text-gray-600',\n\t]\n})\n</script>\n","<template>\n\t<div v-if=\"events.data\">\n\t\t<header\n\tclass=\"sticky top-0 z-10 flex flex-col border-b bg-white px-3 py-2.5 sm:px-5\"\n>\n\t<div class=\"flex justify-between items-center mb-2\">\n\t\t<div>\n\t\t\t<Breadcrumbs\n\t\t\t\tclass=\"h-7\"\n\t\t\t\t:items=\"[{ label: __('All Events'), route: { name: 'Events' } }]\"\n\t\t\t/>\n\t\t</div>\n\t\t<div class=\"flex space-x-2\">\n\t\t\t<FormControl\n\t\t\t\ttype=\"text\"\n\t\t\t\tplaceholder=\"Search Event\"\n\t\t\t\tv-model=\"searchQuery\"\n\t\t\t\t@input=\"events.reload()\"\n\t\t\t>\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<Search class=\"w-4 stroke-1.5 text-gray-600\" name=\"search\" />\n\t\t\t\t</template>\n\t\t\t</FormControl>\n\t\t\t<router-link\n\t\t\t\t:to=\"{\n\t\t\t\t\tname: 'CreateEvent',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\teventName: 'new',\n\t\t\t\t\t},\n\t\t\t\t}\"\n\t\t\t>\n\t\t\t\t<Button v-if=\"user.data?.is_moderator\" variant=\"solid\">\n\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t<Plus class=\"h-4 w-4\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ __('New Event') }}\n\t\t\t\t</Button>\n\t\t\t</router-link>\n\t\t</div>\n\t</div>\n\t<CategoryFilter theme=\"gray\" :categories=\"filter_categories\" @update:categories=\"handleCategoryUpdate\"></CategoryFilter>\n\t<div class=\"flex justify-between items-center\">\n\t\t<div class=\"flex space-x-2\"></div>\n\t<div class=\"flex items-center\"><MultiSelect \n\t  v-model=\"filter_countries\" \n\t  doctype = \"Country\"\n\t  :label=\"__('Country')\"\n\t/></div>\n\t<div class=\"flex flex-wrap gap-4\"><Button  variant=\"solid\" @click=\"logCategories()\">\n\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t<Plus class=\"h-4 w-4\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ __('Apply filter') }}\n\t\t\t\t</Button></div>\n\t\t\t</div>\n\t\n</header>\n\n\t\t\n\t\t<div class=\"\">\n\t\t\t<Tabs\n\t\t\t\tv-model=\"tabIndex\"\n\t\t\t\ttablistClass=\"overflow-x-visible flex-wrap !gap-3 md:flex-nowrap\"\n\t\t\t\t:tabs=\"makeTabs\"\n\t\t\t>\n\t\t\t\t<template #tab=\"{ tab, selected }\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"group -mb-px flex items-center gap-2 overflow-hidden border-b border-transparent py-2.5 text-base text-gray-600 duration-300 ease-in-out hover:border-gray-400 hover:text-gray-900\"\n\t\t\t\t\t\t\t:class=\"{ 'text-gray-900': selected }\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<component v-if=\"tab.icon\" :is=\"tab.icon\" class=\"h-5\" />\n\t\t\t\t\t\t\t{{ __(tab.label) }}\n\t\t\t\t\t\t\t<Badge theme=\"gray\">\n\t\t\t\t\t\t\t\t{{ tab.count }}\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template #default=\"{ tab }\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"tab.events /*&& tab.events.value.length*/\"\n\t\t\t\t\t\tclass=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 my-5 mx-5\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<router-link\n\t\t\t\t\t\t\tv-for=\"eventv in tab.events.value\"\n\t\t\t\t\t\t\t:to=\"\n\t\t\t\t\t\t\t\t{          \n\t\t\t\t\t\t\t\t\t\t\tname: 'EventDetail',\n\t\t\t\t\t\t\t\t\t\t\tparams: { eventName: eventv.name },\n\t\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<EventCard :eventv=\"eventv\" />\n\t\t\t\t\t\t</router-link>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\tclass=\"grid flex-1 place-items-center text-xl font-medium text-gray-500\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex flex-col items-center justify-center mt-4\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{{ __('No {0} Events found').format(tab.label.toLowerCase()) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</Tabs>\n\t\t</div>\n\t</div>\n</template>\n\n<script setup>\nimport {\n\tBreadcrumbs,\n\tTabs,\n\tBadge,\n\tButton,\n\tFormControl,\n\tcreateResource,\n} from 'frappe-ui'\nimport EventCard from '@/components/EventCard.vue'\nimport { Plus, Search } from 'lucide-vue-next'\nimport { ref, computed, inject } from 'vue'\nimport { updateDocumentTitle } from '@/utils'\nimport CategoryFilter from '../components/CategoryFilter.vue'\nimport MultiSelect from '../components/Controls/MultiSelect.vue'\n\n\nconst user = inject('$user')\nconst searchQuery = ref('')\nconst filter_categories = ref([])\nconst filter_countries = ref([])\n\nconst events = createResource({\n\turl: 'ecm.events_connect_management.utils.get_events',\n\tcache: ['events', user.data?.email],\n\tauto: true,\n})\nconst tabIndex = ref(0)\nlet tabs\n\nconst makeTabs = computed(() => {\n\ttabs = []\n\taddToTabs('Featured', getEvents('featured'))\n\taddToTabs('New', getEvents('new'))\n\taddToTabs('Upcoming', getEvents('upcoming'))\n\n\tif (user.data) {\n\t\taddToTabs('Enrolled', getEvents('enrolled'))\n\n\t\tif (\n\t\t\tuser.data.is_moderator ||\n\t\t\tuser.data.is_instructor ||\n\t\t\tevents.data?.created?.length\n\t\t) {\n\t\t\taddToTabs('Created', getEvents('created'))\n\t\t}\n\n\t\tif (user.data.is_moderator) {\n\t\t\taddToTabs('Under Review', getEvents('under_review'))\n\t\t}\n\t}\n\treturn tabs\n})\n\nconst addToTabs = (label, events) => {\n\ttabs.push({\n\t\tlabel,\n\t\tevents: computed(() => events),\n\t\tcount: computed(() => events?.length),\n\t})\n}\n    // Handle the updated categories\n    function handleCategoryUpdate(updatedCategories) {\n\t\tfilter_categories.value = updatedCategories;\n    }\n/* const getCourses = (type) => {\n\tif (searchQuery.value) {\n\t\treturn events.data[type].filter((course) =>\n\t\t\tcourse.title.toLowerCase().includes(searchQuery.value.toLowerCase())\n\t\t)\n\t}\n\treturn events.data[type]\n} */\n    // For debugging purposes\n    function logCategories() {\n\t\tevents.reload()\n    }\n\nconst getEvents = (type) => {\n    return events.data[type].filter((eventv) => {\n        // Filter by search query if it exists\n        const matchesSearchQuery = !searchQuery.value || eventv.title.toLowerCase().includes(searchQuery.value.toLowerCase());\n\n        // Get the list of selected categories\n        const selectedCategories = filter_categories.value.filter(category => category.checked).map(category => category.category);\n\n        // Filter by category if there are selected categories\n        const matchesCategory = selectedCategories.length === 0 || selectedCategories.includes(eventv.category) \n\t\t&& (filter_countries.value.length === 0 || filter_countries.value.includes(eventv.country));\n\t\tconsole.log(\"filter\",filter_countries.value)\n        // Only include events that match both filters\n        return matchesSearchQuery && matchesCategory;\n    });\n}\nconst pageMeta = computed(() => {\n\treturn {\n\t\ttitle: 'Events',\n\t\tdescription: 'All Events divided by categories',\n\t}\n})\n\nupdateDocumentTitle(pageMeta)\n</script>\n"],"names":["sessionStore","props","__props","state","reactive","category","__spreadProps","__spreadValues","watch","newCategories","createResource","data","values","_useModel","emails","ref","search","error","query","text","showOptions","selectedValue","computed","val","addValue","watchDebounced","reload","filterOptions","options","value","_a","removeValue","v","removeLastValue","emailRef","nextTick","setFocus","__expose","labelClasses","user","inject","searchQuery","filter_categories","filter_countries","events","tabIndex","tabs","makeTabs","addToTabs","getEvents","_b","label","handleCategoryUpdate","updatedCategories","logCategories","type","eventv","matchesSearchQuery","selectedCategories","matchesCategory","pageMeta","updateDocumentTitle"],"mappings":"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"}